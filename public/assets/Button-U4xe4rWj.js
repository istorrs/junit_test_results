import{B as k,r as u,c as f,d as B,b as g,m as j,k as F,y as D,e as m,_ as E}from"./index-BzjzKOz-.js";class R{baseUrl="/api/v1";async request(a,s){const n=`${this.baseUrl}${a}`,r=await fetch(n,s);if(!r.ok)throw new Error(`Failed to ${s?.method||"GET"} ${a}: ${r.status}`);return(await r.json()).data}buildQueryString(a){const s=Object.fromEntries(Object.entries(a).filter(([,r])=>r!=null));return Object.keys(s).length===0?"":`?${new URLSearchParams(s).toString()}`}async getRuns(a={}){const s={page:a.page||1,limit:a.limit||50,...a},n=this.buildQueryString(s),r=await this.request(`/runs${n}`);return{runs:r.runs.map(e=>({...e,id:e._id||e.id,summary:{total:e.total_tests||0,passed:(e.total_tests||0)-(e.total_failures||0)-(e.total_errors||0)-(e.total_skipped||0),failed:e.total_failures||0,errors:e.total_errors||0,skipped:e.total_skipped||0}})),pagination:r.pagination}}async getProjects(){return(await this.request("/runs/projects")).projects}async getStats(a={}){const s=this.buildQueryString(a);return this.request(`/stats/overview${s}`)}async getTestCases(a={}){const s={page:a.page||1,limit:a.limit||50,...a},n=this.buildQueryString(s),r=await this.request(`/cases${n}`);return{cases:r.cases.map(e=>({...e,id:e._id||e.id,suite_name:e.classname||e.suite_name,error_message:e.result?.error_message||e.result?.failure_message||e.error_message,error_type:e.result?.error_type||e.result?.failure_type||e.error_type})),pagination:r.pagination}}async uploadTestResults(a){const s=new FormData;s.append("file",a);const n=await fetch(`${this.baseUrl}/upload`,{method:"POST",body:s});if(!n.ok)throw new Error(`Failed to upload test results: ${n.status}`);return(await n.json()).data}}const c=new R,U=k("testData",()=>{const t=u([]),a=u(null),s=u([]),n=u(null),r=u([]),l=u(!1),e=u(null),d=f(()=>t.value.length>0||s.value.length>0),v=f(()=>t.value.length>0?t.value[0]:null);async function y(){l.value=!0,e.value=null;try{r.value=await c.getProjects()}catch(i){throw e.value=i instanceof Error?i.message:"Failed to fetch projects",i}finally{l.value=!1}}async function p(i={}){l.value=!0,e.value=null;try{const o=await c.getRuns(i);return t.value=o.runs,o}catch(o){throw e.value=o instanceof Error?o.message:"Failed to fetch test runs",o}finally{l.value=!1}}async function w(i={}){l.value=!0,e.value=null;try{const o=await c.getTestCases(i);return s.value=o.cases,o}catch(o){throw e.value=o instanceof Error?o.message:"Failed to fetch test cases",o}finally{l.value=!1}}async function h(i={}){l.value=!0,e.value=null;try{return n.value=await c.getStats(i),n.value}catch(o){throw e.value=o instanceof Error?o.message:"Failed to fetch statistics",o}finally{l.value=!1}}async function _(i){l.value=!0,e.value=null;try{const o=await c.uploadTestResults(i);return await Promise.all([p(),h()]),o}catch(o){throw e.value=o instanceof Error?o.message:"Failed to upload file",o}finally{l.value=!1}}function b(i){a.value=i}function S(){e.value=null}function $(){t.value=[],a.value=null,s.value=[],n.value=null,r.value=[],l.value=!1,e.value=null}return{runs:t,currentRun:a,cases:s,stats:n,projects:r,loading:l,error:e,hasData:d,latestRun:v,fetchProjects:y,fetchRuns:p,fetchCases:w,fetchStats:h,uploadFile:_,setCurrentRun:b,clearError:S,reset:$}});function C(t){try{const a=typeof t=="string"?new Date(t):t;return isNaN(a.getTime())?"Invalid Date":a.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}}function z(t){if(t<0||t===0)return"0ms";if(t<1e3)return`${t}ms`;if(t<6e4)return`${(t/1e3).toFixed(2)}s`;const a=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4),n=Math.floor(t%6e4/1e3),r=[];return a>0&&r.push(`${a}h`),s>0&&r.push(`${s}m`),n>0&&r.push(`${n}s`),r.join(" ")}function I(t){return t.toLocaleString("en-US")}function N(t){switch(t.toLowerCase()){case"passed":return"✓";case"failed":return"✗";case"error":return"⚠";case"skipped":return"⊘";default:return"?"}}function O(t){if(t===0)return"0 B";const a=["B","KB","MB","GB","TB"],s=1024,n=Math.floor(Math.log(t)/Math.log(s));return n===0?`${t} ${a[n]}`:`${(t/Math.pow(s,n)).toFixed(2)} ${a[n]}`}function Q(t,a=50){return t.length<=a?t:t.substring(0,a)+"..."}const q=["disabled"],T={key:0,class:"spinner"},M=B({__name:"Button",props:{variant:{default:"primary"},size:{default:"md"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1}},emits:["click"],setup(t,{emit:a}){const s=t,n=a,r=f(()=>["btn",`btn-${s.variant}`,`btn-${s.size}`,{"btn-disabled":s.disabled,"btn-loading":s.loading,"btn-full-width":s.fullWidth}]),l=e=>{!s.disabled&&!s.loading&&n("click",e)};return(e,d)=>(m(),g("button",{class:j(r.value),disabled:t.disabled||t.loading,onClick:l},[t.loading?(m(),g("span",T)):F("",!0),D(e.$slots,"default",{},void 0)],10,q))}}),L=E(M,[["__scopeId","data-v-05997f5e"]]);export{L as B,z as a,C as b,O as c,I as f,N as g,Q as t,U as u};
