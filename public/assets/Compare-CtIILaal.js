import{d as B,r as _,c as V,o as E,b as i,h as s,l as h,i as c,g as y,t as a,e as n,q as x,v as F,F as d,j as r,k as R,_ as P}from"./index-DHPa7hmi.js";import{C as g}from"./Card-C-_JC3MM.js";import{a as T}from"./client-Sj3kfRWu.js";const $={class:"compare-view"},I={class:"run-selector"},L={class:"selector-group"},M=["value"],U={class:"selector-group"},j=["value"],q=["disabled"],z={key:0,class:"loading-state"},A={key:1,class:"error-state"},G={class:"error-message"},H={key:2,class:"comparison-results"},J={class:"runs-grid"},K={class:"run-summary"},O={class:"summary-item"},Q={class:"value"},W={class:"summary-item"},X={class:"value"},Y={class:"summary-item"},Z={class:"value"},ss={class:"summary-item"},es={class:"value failures"},ts={class:"summary-item"},as={class:"value"},ls={class:"summary-item"},is={class:"value"},ns={class:"run-summary"},os={class:"summary-item"},ds={class:"value"},rs={class:"summary-item"},us={class:"value"},cs={class:"summary-item"},_s={class:"value"},ms={class:"summary-item"},vs={class:"value failures"},ps={class:"summary-item"},fs={class:"value"},hs={class:"summary-item"},ys={class:"value"},gs={class:"summary-grid"},bs={class:"summary-stat"},ks={class:"stat-value"},ws={class:"summary-stat new-failures"},Cs={class:"stat-value"},xs={class:"summary-stat fixed"},Fs={class:"stat-value"},Rs={class:"summary-stat"},Ts={class:"stat-value"},Ns={class:"summary-stat"},Ss={class:"stat-value"},Ds={class:"summary-stat"},Bs={class:"stat-value"},Vs={class:"tabs"},Es=["onClick"],Ps={class:"tab-content"},$s={key:0,class:"test-list"},Is={key:0,class:"empty-state"},Ls={class:"test-header"},Ms={class:"test-name"},Us={class:"badge badge-error"},js={class:"test-details"},qs={class:"class-name"},zs={key:0,class:"error-message"},As={key:1,class:"test-list"},Gs={key:0,class:"empty-state"},Hs={class:"test-header"},Js={class:"test-name"},Ks={class:"test-details"},Os={class:"class-name"},Qs={class:"status-change"},Ws={key:2,class:"test-list"},Xs={key:0,class:"empty-state"},Ys={class:"test-header"},Zs={class:"test-name"},se={class:"badge badge-error"},ee={class:"test-details"},te={class:"class-name"},ae={key:3,class:"test-list"},le={key:0,class:"empty-state"},ie={class:"test-header"},ne={class:"test-name"},oe={class:"test-details"},de={class:"class-name"},re={class:"time-change"},ue={key:4,class:"test-list"},ce={key:0,class:"empty-state"},_e={class:"test-header"},me={class:"test-name"},ve={class:"test-details"},pe={class:"class-name"},fe={key:5,class:"test-list"},he={key:0,class:"empty-state"},ye={class:"test-header"},ge={class:"test-name"},be={class:"test-details"},ke={class:"class-name"},we=B({__name:"Compare",setup(Ce){const w=_([]),m=_(""),v=_(""),l=_(null),p=_(!1),f=_(""),u=_("new-failures"),N=[{id:"new-failures",label:"New Failures"},{id:"fixed-tests",label:"Fixed Tests"},{id:"still-failing",label:"Still Failing"},{id:"performance",label:"Performance Changes"},{id:"new-tests",label:"New Tests"},{id:"removed-tests",label:"Removed Tests"}],C=V(()=>m.value&&v.value&&m.value!==v.value),S=o=>{if(!l.value)return 0;switch(o){case"new-failures":return l.value.details.new_failures.length;case"fixed-tests":return l.value.details.fixed_tests.length;case"still-failing":return l.value.details.still_failing.length;case"performance":return l.value.details.performance_changes.length;case"new-tests":return l.value.details.new_tests.length;case"removed-tests":return l.value.details.removed_tests.length;default:return 0}},b=o=>new Date(o).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=o=>{if(o<60)return`${o.toFixed(2)}s`;const e=Math.floor(o/60),t=o%60;return`${e}m ${t.toFixed(0)}s`},D=async()=>{if(C.value){p.value=!0,f.value="",l.value=null;try{const o=await T.compareRuns(m.value,v.value);l.value=o}catch(o){f.value=o instanceof Error?o.message:"Failed to compare test runs",console.error("Error comparing runs:",o)}finally{p.value=!1}}};return E(async()=>{try{const o=await T.getRuns({limit:100});w.value=o.runs}catch(o){f.value="Failed to load test runs",console.error("Error loading runs:",o)}}),(o,e)=>(n(),i("div",$,[e[28]||(e[28]=s("div",{class:"page-header"},[s("h1",null,"Compare Test Runs"),s("p",{class:"subtitle"},"Compare two test runs side-by-side to identify changes")],-1)),h(g,{title:"Select Test Runs to Compare"},{default:y(()=>[s("div",I,[s("div",L,[e[3]||(e[3]=s("label",{for:"run1"},"Test Run 1 (Baseline)",-1)),x(s("select",{id:"run1","onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),class:"run-select"},[e[2]||(e[2]=s("option",{value:""},"Select a test run...",-1)),(n(!0),i(d,null,r(w.value,t=>(n(),i("option",{key:t.id,value:t.id},a(t.name)+" - "+a(b(t.timestamp)),9,M))),128))],512),[[F,m.value]])]),s("div",U,[e[5]||(e[5]=s("label",{for:"run2"},"Test Run 2 (Current)",-1)),x(s("select",{id:"run2","onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),class:"run-select"},[e[4]||(e[4]=s("option",{value:""},"Select a test run...",-1)),(n(!0),i(d,null,r(w.value,t=>(n(),i("option",{key:t.id,value:t.id},a(t.name)+" - "+a(b(t.timestamp)),9,j))),128))],512),[[F,v.value]])]),s("button",{class:"compare-button",disabled:!C.value||p.value,onClick:D},a(p.value?"Comparing...":"Compare"),9,q)])]),_:1}),p.value?(n(),i("div",z,[...e[6]||(e[6]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading comparison...",-1)])])):f.value?(n(),i("div",A,[s("p",G,a(f.value),1)])):l.value?(n(),i("div",H,[s("div",J,[h(g,{title:"Test Run 1 (Baseline)"},{default:y(()=>[s("div",K,[s("div",O,[e[7]||(e[7]=s("span",{class:"label"},"Run ID:",-1)),s("span",Q,a(l.value.run1.id),1)]),s("div",W,[e[8]||(e[8]=s("span",{class:"label"},"Timestamp:",-1)),s("span",X,a(b(l.value.run1.timestamp)),1)]),s("div",Y,[e[9]||(e[9]=s("span",{class:"label"},"Tests:",-1)),s("span",Z,a(l.value.run1.tests),1)]),s("div",ss,[e[10]||(e[10]=s("span",{class:"label"},"Failures:",-1)),s("span",es,a(l.value.run1.failures),1)]),s("div",ts,[e[11]||(e[11]=s("span",{class:"label"},"Pass Rate:",-1)),s("span",as,a(l.value.run1.pass_rate.toFixed(2))+"%",1)]),s("div",ls,[e[12]||(e[12]=s("span",{class:"label"},"Duration:",-1)),s("span",is,a(k(l.value.run1.time)),1)])])]),_:1}),h(g,{title:"Test Run 2 (Current)"},{default:y(()=>[s("div",ns,[s("div",os,[e[13]||(e[13]=s("span",{class:"label"},"Run ID:",-1)),s("span",ds,a(l.value.run2.id),1)]),s("div",rs,[e[14]||(e[14]=s("span",{class:"label"},"Timestamp:",-1)),s("span",us,a(b(l.value.run2.timestamp)),1)]),s("div",cs,[e[15]||(e[15]=s("span",{class:"label"},"Tests:",-1)),s("span",_s,a(l.value.run2.tests),1)]),s("div",ms,[e[16]||(e[16]=s("span",{class:"label"},"Failures:",-1)),s("span",vs,a(l.value.run2.failures),1)]),s("div",ps,[e[17]||(e[17]=s("span",{class:"label"},"Pass Rate:",-1)),s("span",fs,a(l.value.run2.pass_rate.toFixed(2))+"%",1)]),s("div",hs,[e[18]||(e[18]=s("span",{class:"label"},"Duration:",-1)),s("span",ys,a(k(l.value.run2.time)),1)])])]),_:1})]),h(g,{title:"Comparison Summary"},{default:y(()=>[s("div",gs,[s("div",bs,[s("div",ks,a(l.value.summary.total_tests_compared),1),e[19]||(e[19]=s("div",{class:"stat-label"},"Tests Compared",-1))]),s("div",ws,[s("div",Cs,a(l.value.summary.new_failures_count),1),e[20]||(e[20]=s("div",{class:"stat-label"},"New Failures",-1))]),s("div",xs,[s("div",Fs,a(l.value.summary.fixed_tests_count),1),e[21]||(e[21]=s("div",{class:"stat-label"},"Fixed Tests",-1))]),s("div",Rs,[s("div",Ts,a(l.value.summary.still_failing_count),1),e[22]||(e[22]=s("div",{class:"stat-label"},"Still Failing",-1))]),s("div",Ns,[s("div",Ss,a(l.value.summary.status_changes_count),1),e[23]||(e[23]=s("div",{class:"stat-label"},"Status Changes",-1))]),s("div",Ds,[s("div",Bs,a(l.value.summary.performance_changes_count),1),e[24]||(e[24]=s("div",{class:"stat-label"},"Performance Changes",-1))])])]),_:1}),h(g,null,{default:y(()=>[s("div",Vs,[(n(),i(d,null,r(N,t=>s("button",{key:t.id,class:R(["tab",{active:u.value===t.id}]),onClick:xe=>u.value=t.id},a(t.label)+" ("+a(S(t.id))+") ",11,Es)),64))]),s("div",Ps,[u.value==="new-failures"?(n(),i("div",$s,[l.value.details.new_failures.length===0?(n(),i("div",Is," No new failures ")):(n(!0),i(d,{key:1},r(l.value.details.new_failures,t=>(n(),i("div",{key:t.test_id,class:"test-item"},[s("div",Ls,[s("span",Ms,a(t.test_name),1),s("span",Us,a(t.status_after),1)]),s("div",js,[s("span",qs,a(t.class_name),1)]),t.error_message?(n(),i("div",zs,a(t.error_message),1)):c("",!0)]))),128))])):c("",!0),u.value==="fixed-tests"?(n(),i("div",As,[l.value.details.fixed_tests.length===0?(n(),i("div",Gs," No fixed tests ")):(n(!0),i(d,{key:1},r(l.value.details.fixed_tests,t=>(n(),i("div",{key:t.test_id,class:"test-item"},[s("div",Hs,[s("span",Js,a(t.test_name),1),e[25]||(e[25]=s("span",{class:"badge badge-success"},"Fixed",-1))]),s("div",Ks,[s("span",Os,a(t.class_name),1),s("span",Qs,a(t.status_before)+" → "+a(t.status_after),1)])]))),128))])):c("",!0),u.value==="still-failing"?(n(),i("div",Ws,[l.value.details.still_failing.length===0?(n(),i("div",Xs," No tests still failing ")):(n(!0),i(d,{key:1},r(l.value.details.still_failing,t=>(n(),i("div",{key:t.test_id,class:"test-item"},[s("div",Ys,[s("span",Zs,a(t.test_name),1),s("span",se,a(t.status_after),1)]),s("div",ee,[s("span",te,a(t.class_name),1)])]))),128))])):c("",!0),u.value==="performance"?(n(),i("div",ae,[l.value.details.performance_changes.length===0?(n(),i("div",le," No significant performance changes ")):(n(!0),i(d,{key:1},r(l.value.details.performance_changes,t=>(n(),i("div",{key:t.test_id,class:"test-item"},[s("div",ie,[s("span",ne,a(t.test_name),1),s("span",{class:R(["badge",t.time_diff_percent&&t.time_diff_percent>0?"badge-warning":"badge-success"])},a(t.time_diff_percent&&t.time_diff_percent>0?"Slower":"Faster"),3)]),s("div",oe,[s("span",de,a(t.class_name),1),s("span",re,a(k(t.time_before||0))+" → "+a(k(t.time_after||0))+" ("+a(t.time_diff_percent?(t.time_diff_percent>0?"+":"")+t.time_diff_percent.toFixed(1):"0")+"%) ",1)])]))),128))])):c("",!0),u.value==="new-tests"?(n(),i("div",ue,[l.value.details.new_tests.length===0?(n(),i("div",ce," No new tests ")):(n(!0),i(d,{key:1},r(l.value.details.new_tests,t=>(n(),i("div",{key:t.test_id,class:"test-item"},[s("div",_e,[s("span",me,a(t.test_name),1),e[26]||(e[26]=s("span",{class:"badge badge-info"},"New",-1))]),s("div",ve,[s("span",pe,a(t.class_name),1)])]))),128))])):c("",!0),u.value==="removed-tests"?(n(),i("div",fe,[l.value.details.removed_tests.length===0?(n(),i("div",he," No removed tests ")):(n(!0),i(d,{key:1},r(l.value.details.removed_tests,t=>(n(),i("div",{key:t.test_id,class:"test-item"},[s("div",ye,[s("span",ge,a(t.test_name),1),e[27]||(e[27]=s("span",{class:"badge badge-secondary"},"Removed",-1))]),s("div",be,[s("span",ke,a(t.class_name),1)])]))),128))])):c("",!0)])]),_:1})])):c("",!0)]))}}),Ne=P(we,[["__scopeId","data-v-50654c66"]]);export{Ne as default};
